<!DOCTYPE html>
<html lang="zh-Hant">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Helix Drill</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">

  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/header.css">
  <link rel="stylesheet" href="css/sections.css">
  <link rel="stylesheet" href="css/product-card.css">
  <link rel="stylesheet" href="css/hover-effects.css">
  <link rel="stylesheet" href="css/footer.css" />
</head>

<body>

  <nav class="navbar navbar-expand-lg bg-body-tertiary sticky-top" aria-label="主選單">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="#" aria-label="Home">
        <img src="https://nine9.jic-tools.com.tw/themes/nine9/images/logo.png" alt="Nine9">
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav"
        aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="mainNav">
        <h1 data-i18n="helix.title">NC Helix Drill</h1>

        <div class="tab-content d-flex align-items-center gap-2 ms-auto">
          <button class="icon-btn" aria-label="Search">
            <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16"
              aria-hidden="true">
              <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85zm-5.242.656a5 5 0 1 1 0-10 5 5 0 0 1 0 10z" />
            </svg>
          </button>

          <div class="dropdown dropdown-hover">
            <button class="btn btn-outline-secondary dropdown-toggle d-flex align-items-center" type="button"
              id="langMenuBtn" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="me-2"
                viewBox="0 0 16 16" aria-hidden="true">
                <path
                  d="M0 8a8 8 0 1 0 16 0A8 8 0 0 0 0 8m8-7a7 7 0 0 1 6.468 4H8zM1.532 5A7 7 0 0 1 8 1v4zM7 6v4H1.07A6.97 6.97 0 0 1 1 8c0-.69.099-1.356.284-1.988zM8 11v4a7 7 0 0 1-6.468-4zM9 11h5.93A6.97 6.97 0 0 1 15 8c0-.69-.099-1.356-.284-1.988H9zM15 8a7 7 0 0 1-6 6.93V10z" />
              </svg>
              <span data-i18n="nav.lang">Language/Region</span>
            </button>
            <div class="dropdown-menu mega dropdown-menu-end shadow" aria-labelledby="langMenuBtn">
              <div class="container-fluid px-2">
                <div class="row g-3">
                  <div class="col-12 col-lg-6 country-col">
                    <h6>Asia / Pacific</h6>
                    <a class="country-item" href="#" data-lang="zh-TW"><img class="country-flag"
                        src="https://flagcdn.com/tw.svg" alt="Taiwan flag"><span>台灣（繁體中文）</span></a>
                    <a class="country-item" href="#" data-lang="ja-JP"><img class="country-flag"
                        src="https://flagcdn.com/jp.svg" alt="Japan flag"><span>日本</span></a>
                    <a class="country-item disabled" href="#" data-lang="zh-CN" aria-disabled="true" title="暫不提供"><img
                        class="country-flag" src="https://flagcdn.com/cn.svg" alt="China flag"><span>中国（简体中文）</span></a>
                  </div>
                  <div class="col-12 col-lg-6 country-col">
                    <h6>Americas & Europe</h6>
                    <a class="country-item" href="#" data-lang="en-US"><img class="country-flag"
                        src="https://flagcdn.com/us.svg" alt="USA flag"><span>USA</span></a>
                    <a class="country-item" href="#" data-lang="de-DE"><img class="country-flag"
                        src="https://flagcdn.com/de.svg" alt="Germany flag"><span>Deutschland</span></a>
                    <a class="country-item" href="#" data-lang="es-ES"><img class="country-flag"
                        src="https://flagcdn.com/es.svg" alt="Spain flag"><span>España</span></a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <section class="">
    <div class="container my-3">
      <div class="row">
        <div class="col-md-6">
          <div class="row g-3">

            <div class="col-12">
              <div class="card shadow-sm">
                <div class="card-body">
                  <h5 class="card-title mb-3 fw-bold" data-i18n="form.partNo.title">Select Part No.</h5>
                  <div class="row g-3">
                    <div class="col-md-6">
                      <label for="partsGroup1" class="form-label fw-bold" data-i18n="form.partNo.group1">Part No. (99321
                        Series)</label>
                      <select id="partsGroup1" class="form-select" onchange="onPartSelect(this)">
                        <option value="" selected disabled data-i18n="form.common.select">Please select...</option>
                        <option>00-99321-010-1320</option>
                        <option>00-99321-012-1525</option>
                        <option>00-99321-016-2030</option>
                        <option>00-99321-020-2540</option>
                        <option>00-99321-025-3050</option>
                      </select>
                    </div>
                    <div class="col-md-6">
                      <label for="partsGroup2" class="form-label fw-bold" data-i18n="form.partNo.group2">Part No. (99323
                        Series)</label>
                      <select id="partsGroup2" class="form-select" onchange="onPartSelect(this)">
                        <option value="" selected disabled data-i18n="form.common.select">Please select...</option>
                        <option>00-99323-010-1320</option>
                        <option>00-99323-012-1525</option>
                        <option>00-99323-016-2030</option>
                        <option>00-99323-020-2540</option>
                        <option>00-99323-025-3050</option>
                      </select>
                    </div>
                  </div>

                  <div class="mt-3 muted" id="pickedPartInfo" data-i18n="form.partNo.status.none">No Part No. selected.
                  </div>

                  <div class="mt-3 d-none" id="extensionBarBlock">
                    <label class="form-label fw-bold" data-i18n="form.partNo.extBarLabel">Select Extension Bar</label>
                    <select class="form-select" id="extensionBarSelect">
                      <option value="" selected disabled data-i18n="form.common.select">Please select an extension bar
                      </option>
                    </select>
                    <div class="mt-2 text-muted" id="extensionBarStatus" data-i18n="form.partNo.extBarStatus.none">No
                      extension bar selected.</div>
                  </div>
                </div>
              </div>
            </div>

            <hr class="my-4" />

            <div class="col-12">
              <div class="row g-3 align-items-start">
                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.material.label">Workpiece material</label>
                  <select class="form-select" id="selectMaterial" onchange="updateCuttingSpeed(); updateSelectColor()">
                    <option value="" disabled selected data-i18n="form.common.select">Select material</option>
                    <option value="Material01" data-group="P" data-color="#0066CC"
                      style="background-color:#0066CC;color:white;font-weight:bold;">P — Carbon steel C&lt;0.3%</option>
                    <option value="Material02" data-group="P" data-color="#0066CC"
                      style="background-color:#0066CC;color:white;font-weight:bold;">P — Carbon steel C&gt;0.3%</option>
                    <option value="Material03" data-group="P" data-color="#0066CC"
                      style="background-color:#0066CC;color:white;font-weight:bold;">P — Low alloy steel C&lt;0.3%
                    </option>
                    <option value="Material04" data-group="P" data-color="#0066CC"
                      style="background-color:#0066CC;color:white;font-weight:bold;">P — High alloy steel</option>
                    <option value="Material06" data-group="M" data-color="#FFC000"
                      style="background-color:#FFC000;font-weight:bold;">M — Stainless steel</option>
                    <option value="Material07" data-group="K" data-color="#FF0000"
                      style="background-color:#FF0000;color:white;font-weight:bold;">K — Cast iron</option>
                    <option value="Material08" data-group="N" data-color="#00B050"
                      style="background-color:#00B050;color:white;font-weight:bold;">N — Al, Al-alloys</option>
                    <option value="Material09" data-group="N" data-color="#00B050"
                      style="background-color:#00B050;color:white;font-weight:bold;">N — Cu, Cu-alloy, casting Cu-alloy
                    </option>
                    <option value="Material10" data-group="S" data-color="#E6007E"
                      style="background-color:#E6007E;color:white;font-weight:bold;">S — Heat resistant alloy</option>
                    <option value="Material11" data-group="S" data-color="#E6007E"
                      style="background-color:#E6007E;color:white;font-weight:bold;">S — Ti, Ti-alloy</option>
                    <option value="Material12" data-group="H" data-color="#A6A6A6"
                      style="background-color:#A6A6A6;font-weight:bold;">H — Hardened steel &lt; HRC50</option>
                  </select>
                  <small class="text-muted d-block muted mb-4 my-2" id="materialHint">ISO group: –</small>
                </div>

                <div class="col-md-6 fw-bold">
                  <div class="btn-group w-100 mb-2" role="group" aria-label="Modes">
                    <button type="button" class="btn btn-primary mode-btn" data-mode="Mode1"
                      data-i18n="form.mode.mode1">Mode1</button>
                    <button type="button" class="btn btn-outline-primary mode-btn" data-mode="Mode2"
                      data-i18n="form.mode.mode2">Mode2</button>
                  </div>
                  <div class="card shadow-sm" id="imgCard">
                    <div class="card-body d-flex justify-content-center align-items-center" style="min-height:220px;">
                      <img id="galleryImg"
                        src="https://nine9.jic-tools.com.tw/upload_files/technology/NC_Helix_Drill/icon_helix_fig.01.jpg"
                        class="img-fluid rounded" alt="preview">
                    </div>
                    <!-- <div class="card-footer text-center small text-muted" id="modeHint"></div> -->
                  </div>
                </div>
              </div>
            </div>

            <hr class="my-4" />

            <div class="col-12">
              <div class="row g-3 align-items-start">
                <div id="group1" class="col-md-6">
                  <label class="form-label fw-bold" data-i18n="form.params.preBore">Pre-bore diameter</label>
                  <div class="input-group mb-2">
                    <input type="number" class="form-control" id="preBore1" data-i18n-placeholder="form.placeholders.mm"
                      step="0.001">
                    <button type="button"
                      class="btn btn-light btn-sm border-success text-success fw-bold px-5 py-1 btn-ce" id="preBoreCe1"
                      data-i18n="form.common.clear">Clear</button>
                  </div>

                  <label class="form-label fw-bold" data-i18n="form.params.machiningDia">Machining Diameter</label>
                  <div class="input-group mb-2">
                    <input type="number" class="form-control" id="machiningDia1" placeholder="Ød1 / mm" step="0.001">
                    <button type="button"
                      class="btn btn-light btn-sm border-success text-success fw-bold px-5 py-1 btn-ce"
                      id="machiningDiaCe1" data-i18n="form.common.clear">Clear</button>
                  </div>

                  <label class="form-label fw-bold" data-i18n="form.params.depth">Depth of Cut</label>
                  <div class="input-group mb-2">
                    <input type="number" class="form-control" id="depthDia1" placeholder="L1 / mm" step="0.001">
                    <button type="button"
                      class="btn btn-light btn-sm border-success text-success fw-bold px-5 py-1 btn-ce" id="depthDiaCe1"
                      data-i18n="form.common.clear">Clear</button>
                  </div>

                  <label class="form-label fw-bold" data-i18n="form.params.pitch">Pitch</label>
                  <div class="input-group mb-2">
                    <input type="number" class="form-control" id="pitch1" placeholder="P1 / mm" step="0.001">
                    <button type="button"
                      class="btn btn-light btn-sm border-success text-success fw-bold px-5 py-1 btn-ce" id="pitchCe1"
                      data-i18n="form.common.clear">Clear</button>
                  </div>
                </div>

                <div id="group2" class="col-md-6 d-none">
                  <label class="form-label fw-bold" data-i18n="form.params.preBore">Pre-bore diameter</label>
                  <div class="input-group mb-2">
                    <input type="number" class="form-control" id="preBore2" data-i18n-placeholder="form.placeholders.mm"
                      step="0.001">
                    <button type="button"
                      class="btn btn-light btn-sm border-success text-success fw-bold px-5 py-1 btn-ce" id="preBoreCe2"
                      data-i18n="form.common.clear">Clear</button>
                  </div>

                  <label class="form-label fw-bold" data-i18n="form.params.machiningDia">Machining Diameter</label>
                  <div class="input-group mb-2">
                    <input type="number" class="form-control" id="machiningDia2" placeholder="Ød2 / mm" step="0.001">
                    <button type="button"
                      class="btn btn-light btn-sm border-success text-success fw-bold px-5 py-1 btn-ce"
                      id="machiningDiaCe2" data-i18n="form.common.clear">Clear</button>
                  </div>

                  <label class="form-label fw-bold" data-i18n="form.params.depth">Depth of Cut</label>
                  <div class="input-group mb-2">
                    <input type="number" class="form-control" id="depthDia2" placeholder="L2 / mm" step="0.001">
                    <button type="button"
                      class="btn btn-light btn-sm border-success text-success fw-bold px-5 py-1 btn-ce" id="depthDiaCe2"
                      data-i18n="form.common.clear">Clear</button>
                  </div>

                  <label class="form-label fw-bold" data-i18n="form.params.pitch">Pitch</label>
                  <div class="input-group mb-2">
                    <input type="number" class="form-control" id="pitch2" placeholder="P2 / mm" step="0.001">
                    <button type="button"
                      class="btn btn-light btn-sm border-success text-success fw-bold px-5 py-1 btn-ce" id="pitchCe2"
                      data-i18n="form.common.clear">Clear</button>
                  </div>
                </div>
              </div>
            </div>

            <hr class="my-4" />

            <div class="col-12">
              <div class="row g-3">
                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.toolDia">Tool Diameter ØDc</label>
                  <input type="text" class="form-control bg-light" id="toolDiameter" readonly
                    style="cursor:not-allowed;" data-i18n-placeholder="form.placeholders.selectTool"
                    oninput="updateSpindleSpeed()">
                </div>

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.cuttingSpeed">Cutting Speed</label>
                  <input type="number" class="form-control" id="vc" data-i18n-placeholder="form.placeholders.m_min"
                    oninput="updateSpindleSpeed()" />
                </div>

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.spindleSpeed">Spindle Speed</label>
                  <input type="number" class="form-control" id="n" data-i18n-placeholder="form.placeholders.rpm"
                    readonly style="background-color:#d4edda;cursor:not-allowed;" />
                </div>

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.teeth">Number of Teeth</label>
                  <input type="number" class="form-control bg-light" style="cursor:not-allowed;" id="z" value="2"
                    readonly oninput="updateFeedRate()" />
                </div>

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.feedPerTooth">Feed per Tooth</label>
                  <input type="number" class="form-control" id="fz" data-i18n-placeholder="form.placeholders.mm_tooth"
                    step="0.001" required oninput="updateFeedRate()" />
                </div>

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.feedRate">Feed Rate</label>
                  <input type="number" class="form-control" id="vf" data-i18n-placeholder="form.placeholders.mm_min"
                    readonly style="background-color:#d4edda;cursor:not-allowed;" />
                </div>

                <hr class="my-4" />

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.toolNo">Tool Number</label>
                  <input type="number" class="form-control" id="toolNo" value="99" />
                </div>

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.coorSystem">Coordinate System</label>
                  <input type="text" class="form-control" id="gcode" value="G54" />
                </div>

                <hr class="my-4" />

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.coorX">Coordinate X</label>
                  <input type="number" class="form-control" id="x" value="0" />
                </div>

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.coorY">Coordinate Y</label>
                  <input type="number" class="form-control" id="y" value="0" />
                </div>

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.safeZ">Safe Height Z</label>
                  <input type="number" class="form-control" id="zsafe" value="20" />
                </div>

                <div class="col-md-6 fw-bold">
                  <label class="form-label" data-i18n="form.others.surfaceZ">Surface Coordinate Z</label>
                  <input type="number" class="form-control" id="zsurface" value="0" />
                </div>

                <hr class="my-4" />
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-6 my-3">
          <div class="right-pane-sticky">
            <div class="d-flex justify-content-end mb-2">
              <button class="btn btn-secondary me-2 fw-bold" onclick="addTool(); countClick('addTool')"
                data-i18n="form.actions.addTool">Add Tool</button>
              <button class="btn btn-primary me-2 fw-bold" onclick="calculateGCode(); countClick('calculate')"
                data-i18n="form.actions.generate">Generate</button>
              <button class="btn btn-success me-2 fw-bold" onclick="exportToFile(); countClick('export')"
                data-i18n="form.actions.export">Export</button>
              <button class="btn btn-danger fw-bold" onclick="clearOutput(); countClick('clear')"
                data-i18n="form.actions.clear">Clear</button>
            </div>
            <textarea id="result" class="form-control my-3" readonly style="height: 85vh;"></textarea>
            <div id="machiningTimeResult" class="mt-2 text-end fw-bold fs-5"></div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const PART_TO_BARS = { "00-99323-010-1320": ["00-99801-10S", "00-99801-10W"], "00-99323-012-1525": ["00-99801-12S", "00-99801-12W"], "00-99323-016-2030": ["00-99801-16S", "00-99801-14W", "00-99801-16W"], "00-99323-020-2540": ["00-99801-20S", "00-99801-18W", "00-99801-20W"], "00-99323-025-3050": ["00-99801-25S", "00-99801-25W"] };
      const BAR_DB = { "00-99801-10S": { type: "", torque: "" }, "00-99801-10W": { type: "", torque: "" }, "00-99801-12S": { type: "", torque: "" }, "00-99801-12W": { type: "", torque: "" }, "00-99801-14W": { type: "", torque: "" }, "00-99801-16S": { type: "", torque: "" }, "00-99801-16W": { type: "", torque: "" }, "00-99801-18W": { type: "", torque: "" }, "00-99801-20S": { type: "", torque: "" }, "00-99801-20W": { type: "", torque: "" }, "00-99801-25S": { type: "", torque: "" }, "00-99801-25W": { type: "", torque: "" } };
      const PART_TO_DIAMETER = { "00-99321-010-1320": 11.0, "00-99323-010-1320": 11.0, "00-99321-012-1525": 13.0, "00-99323-012-1525": 13.0, "00-99321-016-2030": 17.0, "00-99323-016-2030": 17.0, "00-99321-020-2540": 22.0, "00-99323-020-2540": 22.0, "00-99321-025-3050": 27.0, "00-99323-025-3050": 27.0 };

      function applyInsertDiameterByPart(partNo) {
        const td = document.getElementById('toolDiameter');
        td.value = PART_TO_DIAMETER[partNo]?.toFixed(1) || '';
        if (typeof updateSpindleSpeed === 'function') { try { updateSpindleSpeed(); } catch (e) { } }
      }

      function buildExtensionOptions(partNo) {
        const extSelect = document.getElementById('extensionBarSelect');
        const allowed = PART_TO_BARS[partNo] || Object.keys(BAR_DB);
        extSelect.innerHTML = `<option value="" selected disabled>${LangCtl.get('form.common.select')}</option>`;
        allowed.forEach(code => {
          const meta = BAR_DB[code] || { type: "", torque: "" };
          const opt = document.createElement('option');
          opt.value = code; opt.dataset.type = meta.type; opt.dataset.torque = meta.torque;
          const label = [code]; if (meta.type) label.push(meta.type); if (meta.torque) label.push(`Torque: ${meta.torque}`);
          opt.textContent = label.join(' | ');
          extSelect.appendChild(opt);
        });
      }

      function hideExtensionBar() {
        document.getElementById('extensionBarBlock').classList.add('d-none');
        document.getElementById('extensionBarSelect').innerHTML = `<option value="" selected disabled>${LangCtl.get('form.common.select')}</option>`;
        const extStatus = document.getElementById('extensionBarStatus');
        extStatus.textContent = LangCtl.get('form.partNo.extBarStatus.none');
        extStatus.className = 'mt-2 text-muted';
      }

      function updateUIByPart(partNo) {
        applyInsertDiameterByPart(partNo);
        if (!/^00-99323-/.test(partNo)) { hideExtensionBar(); return; }
        const extBlock = document.getElementById('extensionBarBlock');
        const extStatus = document.getElementById('extensionBarStatus');
        buildExtensionOptions(partNo);
        extBlock.classList.remove('d-none');
        extStatus.textContent = LangCtl.get('form.partNo.extBarStatus.none');
        extStatus.className = 'mt-2 text-muted';
      }

      document.getElementById('extensionBarSelect').addEventListener('change', function () {
        const opt = this.options[this.selectedIndex];
        const status = document.getElementById('extensionBarStatus');
        if (opt && opt.value) {
          const bits = [opt.value, opt.dataset.type, opt.dataset.torque && `Torque: ${opt.dataset.torque}`].filter(Boolean);
          status.textContent = `${LangCtl.get('form.partNo.extBarStatus.selected')}: ${bits.join(' | ')}`;
          status.className = 'mt-2 fw-bold text-success';
        } else {
          status.textContent = LangCtl.get('form.partNo.extBarStatus.none');
          status.className = 'mt-2 text-muted';
        }
      });

      function onPartSelect(sel) {
        const g1 = document.getElementById('partsGroup1'), g2 = document.getElementById('partsGroup2'), pickedInfo = document.getElementById('pickedPartInfo');
        if (sel.id === 'partsGroup1') { g2.selectedIndex = 0; } else { g1.selectedIndex = 0; }
        const val = sel.value || sel.options[sel.selectedIndex]?.text;
        if (val) {
          pickedInfo.textContent = `${LangCtl.get('form.partNo.status.selected')}: ${val}`;
          pickedInfo.className = 'mt-3 text-success fw-bold';
        } else {
          pickedInfo.textContent = LangCtl.get('form.partNo.status.none');
          pickedInfo.className = 'mt-3 muted';
        }
        if (val) updateUIByPart(val);
        if (typeof updateCuttingSpeed === 'function') updateCuttingSpeed();
        if (typeof window.syncFzBlink === 'function') window.syncFzBlink();
      }
    </script>

    <script>
      function updateSelectColor() {
        const sel = document.getElementById('selectMaterial'), opt = sel.options[sel.selectedIndex];
        if (!opt) return;
        const color = opt.dataset.color || '', group = opt.dataset.group || '';
        sel.style.backgroundColor = color;
        sel.style.color = ['#0066CC', '#FF0000', '#00B050', '#E6007E'].includes(color) ? '#fff' : '#000';
        document.getElementById('materialHint').textContent = group ? `${LangCtl.get('form.material.isoHint')}: ${group}` : `${LangCtl.get('form.material.isoHint')}: –`;
      }
      document.addEventListener('DOMContentLoaded', () => { updateSelectColor(); updateCuttingSpeed(); });
    </script>

    <script>
      const cuttingSpeedMapBySeries = { "99321": { Material01: { vc: 120 }, Material02: { vc: 100 }, Material03: { vc: 70 }, Material04: { vc: 60 }, Material06: { vc: 60 }, Material07: { vc: 70 }, Material08: { vc: 350 }, Material09: { vc: 200 }, Material10: { vc: 20 }, Material11: { vc: 40 }, Material12: { vc: 60 } }, "99323": { Material01: { vc: 200 }, Material02: { vc: 150 }, Material03: { vc: 120 }, Material04: { vc: 90 }, Material06: { vc: 90 }, Material07: { vc: 120 }, Material08: { vc: 500 }, Material09: { vc: 400 }, Material10: { vc: 30 }, Material11: { vc: 60 }, Material12: { vc: 90 } } };
      function getSelectedPartNo() { return document.getElementById('partsGroup2').value || document.getElementById('partsGroup1').value || ""; }
      function getSeriesFromPart(partNo) { if (/^00-99323-/.test(partNo)) return "99323"; if (/^00-99321-/.test(partNo)) return "99321"; return null; }
      function updateCuttingSpeed() {
        const material = document.getElementById("selectMaterial").value, partNo = getSelectedPartNo(), series = getSeriesFromPart(partNo) || "99321";
        const data = cuttingSpeedMapBySeries[series]?.[material];
        const vcInput = document.getElementById("vc"), fzInput = document.getElementById("fz");
        vcInput.value = data?.vc ?? "";
        if (data && typeof data.fz !== "undefined") { fzInput.value = data.fz; }
        if (typeof updateSpindleSpeed === "function") updateSpindleSpeed();
        if (typeof window.syncFzBlink === "function") window.syncFzBlink();
      }
    </script>

    <script>
      function updateSpindleSpeed() {
        const d = parseFloat(document.getElementById("toolDiameter").value), vc = parseFloat(document.getElementById("vc").value);
        document.getElementById("n").value = (!isNaN(d) && d > 0 && !isNaN(vc) && vc > 0) ? ((1000 * vc) / (Math.PI * d)).toFixed(0) : "";
        updateFeedRate();
        if (typeof window.syncFzBlink === 'function') window.syncFzBlink();
      }
      function updateFeedRate() {
        const z = parseFloat(document.getElementById("z").value), fz = parseFloat(document.getElementById("fz").value), n = parseFloat(document.getElementById("n").value);
        document.getElementById("vf").value = (!isNaN(z) && !isNaN(fz) && !isNaN(n) && z > 0 && fz > 0 && n > 0) ? (n * fz * z).toFixed(2) : "";
      }
    </script>

    <script>
      function addTool() {
        const toolNo = document.getElementById("toolNo").value || '99', spindleSpeed = document.getElementById("n").value || '';
        const gcode = [`G90 G17 G21 G49 G80`, `T${toolNo} M06`, `S${spindleSpeed} M03`, `M08`].join('\n');
        const sys = (document.getElementById("gcode").value || 'G54').trim();
        document.getElementById("result").value += `${gcode}\n${sys}\n\n`;

      }
      function clearOutput() { document.getElementById("result").value = ""; }
      function exportToFile() {
        let content = document.getElementById("result").value || "";
        if (content && !content.endsWith('\n')) content += '\n';
        const footer = ['M05', 'M09', 'G91 G28 Z0.', 'G91 G28 Y0.', 'M30'].join('\n');
        content += footer + '\n';
        const mode = window.currentMode || 'Mode1', ts = new Date().toISOString().replace(/[:.]/g, '-');
        const a = document.createElement("a");
        a.href = URL.createObjectURL(new Blob([content], { type: "text/plain" }));
        a.download = `NC_Helix_Drill_${mode}_${ts}.txt`;
        document.body.appendChild(a);
        a.click();
        setTimeout(() => { URL.revokeObjectURL(a.href); document.body.removeChild(a); }, 0);
      }
      function countClick() { }
    </script>

    <script>
      (function () {
        const fz = document.getElementById('fz'); let timer = null;
        function shouldBlink() {
          const fzVal = parseFloat(fz.value); const isFzMissing = isNaN(fzVal) || fzVal <= 0;
          const hasN = parseFloat(document.getElementById('n').value) > 0;
          return isFzMissing && hasN;
        }
        function sync() { if (shouldBlink()) { if (!timer) timer = setInterval(() => fz.classList.toggle('blink'), 650); } else { if (timer) { clearInterval(timer); timer = null; } fz.classList.remove('blink'); } }
        window.syncFzBlink = sync;
        fz.addEventListener('input', sync);
        document.addEventListener('DOMContentLoaded', sync);
      })();
    </script>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const pairs = [['preBoreCe1', 'preBore1'], ['machiningDiaCe1', 'machiningDia1'], ['depthDiaCe1', 'depthDia1'], ['pitchCe1', 'pitch1'], ['preBoreCe2', 'preBore2'], ['machiningDiaCe2', 'machiningDia2'], ['depthDiaCe2', 'depthDia2'], ['pitchCe2', 'pitch2']];
        pairs.forEach(([btnId, fieldId]) => {
          const btn = document.getElementById(btnId);
          if (btn) btn.addEventListener('click', () => {
            const el = document.getElementById(fieldId);
            if (el) { el.value = ''; el.dispatchEvent(new Event('input', { bubbles: true })); el.focus(); }
            if (typeof updateSpindleSpeed === 'function') updateSpindleSpeed();
          });
        });
      });
    </script>

    <script>
      const imagesByMode = { Mode1: "https://nine9.jic-tools.com.tw/upload_files/technology/NC_Helix_Drill/icon_helix_fig.01.jpg", Mode2: "https://nine9.jic-tools.com.tw/upload_files/technology/NC_Helix_Drill/icon_helix_fig.02.jpg" };
      const imgEl = document.getElementById("galleryImg"), modeBtns = document.querySelectorAll(".mode-btn"), group1 = document.getElementById("group1"), group2 = document.getElementById("group2");
      let currentMode = 'Mode1';

      function setMode(mode) {
        currentMode = mode;
        imgEl.src = imagesByMode[mode] || "";
        modeBtns.forEach(b => {
          const active = b.dataset.mode === mode;
          b.classList.toggle("btn-primary", active);
          b.classList.toggle("btn-outline-primary", !active);
        });
        const showSecond = mode === "Mode2";
        group2.classList.toggle("d-none", !showSecond);
        group1.classList.toggle("col-12", !showSecond);
        group1.classList.toggle("col-md-6", showSecond);
        if (!showSecond) { ["preBore2", "machiningDia2", "depthDia2", "pitch2"].forEach(id => { const el = document.getElementById(id); if (el) el.value = ""; }); }
        const hint = document.getElementById("modeHint");
        if (hint) { hint.textContent = LangCtl.get(`form.modeDesc.${mode.toLowerCase()}`, ''); }
      }
      modeBtns.forEach(btn => btn.addEventListener("click", () => setMode(btn.dataset.mode)));
      setMode("Mode1");
    </script>

    <!-- <script>
      function calculateGCode() {
        const mode = currentMode || 'Mode1';
        const out = [], result = document.getElementById('result');
        const num = id => { const v = parseFloat(document.getElementById(id)?.value); return isNaN(v) ? null : v; };
        const txt = id => (document.getElementById(id)?.value ?? "").trim();
        const fmt = (v, dec = 3) => (v == null || isNaN(v)) ? '-' : (+v).toFixed(dec);
        const toolNo = txt('toolNo') || '99', sys = txt('gcode') || 'G54', x0 = num('x') ?? 0, y0 = num('y') ?? 0, zsafe = num('zsafe') ?? 20, zsurf = num('zsurface') ?? 0, Dc = num('toolDiameter'), Vc = num('vc'), N = num('n'), Zteeth = num('z'), Fz = num('fz');
        let Vf = num('vf');
        if ((Vf == null || isNaN(Vf)) && N && Fz && Zteeth) { Vf = N * Fz * Zteeth; }

        out.push(`(=== NC Helix Drill / ${mode} ===)`);
        out.push(`(Tool Dc=${fmt(Dc, 3)} mm, Vc=${fmt(Vc, 1)} m/min, N=${fmt(N, 0)} rpm, z=${fmt(Zteeth, 0)}, fz=${fmt(Fz, 3)} mm/tooth, Vf=${fmt(Vf, 1)} mm/min)`);
        out.push(`${sys} G00 X${fmt(x0, 3)} Y${fmt(y0, 3)} `);
        out.push(`G43 H${toolNo} Z${fmt(zsafe, 3)} `);

        function buildHelixSection(label, machiningDia, depth, pitch) {
          if (machiningDia == null || depth == null || pitch == null) return [`(WARN) ${label}: missing required fields, skipped.`];
          if (!Dc) return [`(WARN) ${label}: unknown tool diameter (Dc), skipped.`];
          const block = [], R = (machiningDia - Dc) / 2, steps = Math.max(1, Math.ceil(depth / pitch)), effPitch = depth / steps;
          block.push(`(--- ${label} ---)`, `(Target Ø=${fmt(machiningDia, 3)}; Depth L=${fmt(depth, 3)}; Pitch=${fmt(pitch, 3)}; R=${fmt(R, 3)})`, `G00 Z${fmt(zsurf + 2, 3)}`);
          if (R > 1e-4) {
            block.push(`G01 X${fmt(x0 + R, 3)} Z${fmt(zsurf, 3)} F${fmt(Vf || 200, 1)}`);
            let currentZ = zsurf;
            for (let i = 1; i <= steps; i++) { currentZ -= effPitch; block.push(`G03 I${fmt(-R, 3)} Z${fmt(currentZ, 3)} F${fmt(Vf || 200, 1)} `); }
          }
          // else { block.push(`(NOTE) R<=0，改為直下鑽削；Fallback to drilling)`, `G01 Z${fmt(zsurf, 3)} F${fmt(Vf || 200, 1)} (到工面；To surface)`, `G01 Z${fmt(zsurf - depth, 3)} F${fmt(Vf || 200, 1)} (直下到目標深度；Plunge to depth)`); }

          block.push(`G03 I${fmt(-R, 3)} F${fmt(Vf || 200, 1)}`, `G01 X${fmt(x0, 3)} Y${fmt(y0, 3)} F${fmt(Vf || 200, 1)}  `, `G00 Z${fmt(zsafe, 3)}  `);
          return block;
        }

        if (mode === 'Mode1') { out.push(...buildHelixSection('Mode1', num('machiningDia1'), num('depthDia1'), num('pitch1'))); }
        else if (mode === 'Mode2') {
          out.push(...buildHelixSection('Mode2_Step1', num('machiningDia1'), num('depthDia1'), num('pitch1')));
          out.push(...buildHelixSection('Mode2_Step2', num('machiningDia2'), num('depthDia2'), num('pitch2')));
        }
        out.push(`(=== End ===)`);
        if (result.value && !result.value.endsWith('\n')) result.value += '\n';
        result.value += out.join('\n') + '\n\n';
        result.scrollTop = result.scrollHeight;
      }
    </script> -->

    <!-- <script>
      // ▼▼▼ 更新後的 G-code 產生與時間計算函式 ▼▼▼
      function calculateGCode() {
        const mode = currentMode || 'Mode1';
        const out = [], result = document.getElementById('result');
        const timeResultEl = document.getElementById('machiningTimeResult');
        
        let totalCuttingDistance = 0; // 累計總切削路徑

        const num = id => { const v = parseFloat(document.getElementById(id)?.value); return isNaN(v) ? null : v; };
        const txt = id => (document.getElementById(id)?.value ?? "").trim();
        const fmt = (v, dec = 3) => (v == null || isNaN(v)) ? '-' : (+v).toFixed(dec);
        
        const toolNo = txt('toolNo') || '99', sys = txt('gcode') || 'G54', x0 = num('x') ?? 0, y0 = num('y') ?? 0, zsafe = num('zsafe') ?? 20, zsurf = num('zsurface') ?? 0, Dc = num('toolDiameter'), Vc = num('vc'), N = num('n'), Zteeth = num('z'), Fz = num('fz');
        let Vf = num('vf');
        if ((Vf == null || isNaN(Vf)) && N && Fz && Zteeth) { Vf = N * Fz * Zteeth; }

        out.push(`(=== NC Helix Drill / ${mode} ===)`);
        out.push(`(Tool Dc=${fmt(Dc, 3)} mm, Vc=${fmt(Vc, 1)} m/min, N=${fmt(N, 0)} rpm, z=${fmt(Zteeth, 0)}, fz=${fmt(Fz, 3)} mm/tooth, Vf=${fmt(Vf, 1)} mm/min)`);
        out.push(`${sys} G00 X${fmt(x0, 3)} Y${fmt(y0, 3)} `);
        out.push(`G43 H${toolNo} Z${fmt(zsafe, 3)} `);

        function buildHelixSection(label, machiningDia, depth, pitch) {
          let sectionDistance = 0;
          if (machiningDia == null || depth == null || pitch == null) return { gcode: [`(WARN) ${label}: missing required fields, skipped.`], distance: 0 };
          if (!Dc) return { gcode: [`(WARN) ${label}: unknown tool diameter (Dc), skipped.`], distance: 0 };
          
          const block = [], R = (machiningDia - Dc) / 2, steps = Math.max(1, Math.ceil(depth / pitch)), effPitch = depth / steps;
          block.push(`(--- ${label} ---)`, `(Target Ø=${fmt(machiningDia, 3)}; Depth L=${fmt(depth, 3)}; Pitch=${fmt(pitch, 3)}; R=${fmt(R, 3)})`, `G00 Z${fmt(zsurf + 2, 3)} `);
          
          if (R > 1e-4) {
            block.push(`G01 X${fmt(x0 + R, 3)} Z${fmt(zsurf, 3)} F${fmt(Vf || 200, 1)} `);
            sectionDistance += Math.sqrt(R*R + 2*2); // 計算斜線進刀距離

            let currentZ = zsurf;
            for (let i = 1; i <= steps; i++) {
              currentZ -= effPitch;
              block.push(`G03 I${fmt(-R, 3)} Z${fmt(currentZ, 3)} F${fmt(Vf || 200, 1)} `);
              sectionDistance += Math.sqrt(Math.pow(2 * Math.PI * R, 2) + Math.pow(effPitch, 2)); // 累計每圈螺旋線長
            }
          }
          //  else {
          //   block.push(`(NOTE) R<=0，改為直下鑽削；Fallback to drilling)`, `G01 Z${fmt(zsurf, 3)} F${fmt(Vf || 200, 1)} (到工面；To surface)`, `G01 Z${fmt(zsurf - depth, 3)} F${fmt(Vf || 200, 1)} (直下到目標深度；Plunge to depth)`);
          //   sectionDistance += depth; // 直下鑽孔距離
          // }

          block.push(`G03 I${fmt(-R, 3)} F${fmt(Vf || 200, 1)}  `);
          sectionDistance += 2 * Math.PI * R; // 整圓一圈的距離

          block.push(`G01 X${fmt(x0, 3)} Y${fmt(y0, 3)} F${fmt(Vf || 200, 1)} `);
          sectionDistance += R; // 回到中心的距離

          block.push(`G00 Z${fmt(zsafe, 3)}  `);
          return { gcode: block, distance: sectionDistance };
        }

        if (mode === 'Mode1') {
          const section = buildHelixSection('Mode1', num('machiningDia1'), num('depthDia1'), num('pitch1'));
          out.push(...section.gcode);
          totalCuttingDistance += section.distance;
        } else if (mode === 'Mode2') {
          const section1 = buildHelixSection('Mode2_Step1', num('machiningDia1'), num('depthDia1'), num('pitch1'));
          out.push(...section1.gcode);
          totalCuttingDistance += section1.distance;

          const section2 = buildHelixSection('Mode2_Step2', num('machiningDia2'), num('depthDia2'), num('pitch2'));
          out.push(...section2.gcode);
          totalCuttingDistance += section2.distance;
        }

        out.push(`(=== End ===)`);
        if (result.value && !result.value.endsWith('\n')) result.value += '\n';
        result.value += out.join('\n') + '\n\n';
        result.scrollTop = result.scrollHeight;

        // 計算並顯示時間
        if (Vf > 0 && totalCuttingDistance > 0) {
          const timeInMinutes = totalCuttingDistance / Vf;
          const timeInSeconds = timeInMinutes * 60;
          const timeTemplate = LangCtl.get('form.results.machiningTime', 'Estimated Machining Time: {time} sec');
          timeResultEl.textContent = timeTemplate.replace('{time}', timeInSeconds.toFixed(2));
          timeResultEl.classList.remove('text-muted');
          timeResultEl.classList.add('text-primary');
        } else {
          timeResultEl.textContent = ''; // 如果無法計算則清空
        }
      }

      // 同時也更新 clearOutput 函式
      function clearOutput() {
        document.getElementById("result").value = "";
        document.getElementById('machiningTimeResult').textContent = ''; // 清除時間
      }
    </script> -->

    <script>

      // ▼▼▼ 1. 在函式外部建立一個變數來累計總時間 ▼▼▼
      let cumulativeMachiningTimeInSeconds = 0;

      function setMode(mode) {
        currentMode = mode;
        imgEl.src = imagesByMode[mode] || "";
        modeBtns.forEach(b => {
          const active = b.dataset.mode === mode;
          b.classList.toggle("btn-primary", active);
          b.classList.toggle("btn-outline-primary", !active);
        });
        const showSecond = mode === "Mode2";
        group2.classList.toggle("d-none", !showSecond);
        group1.classList.toggle("col-12", !showSecond);
        group1.classList.toggle("col-md-6", showSecond);
        if (!showSecond) { ["preBore2", "machiningDia2", "depthDia2", "pitch2"].forEach(id => { const el = document.getElementById(id); if (el) el.value = ""; }); }
        const hint = document.getElementById("modeHint");
        if (hint) { hint.textContent = LangCtl.get(`form.modeDesc.${mode.toLowerCase()}`, ''); }
      }
      modeBtns.forEach(btn => btn.addEventListener("click", () => setMode(btn.dataset.mode)));
      setMode("Mode1");

      function calculateGCode() {
        const mode = currentMode || 'Mode1';
        const out = [], result = document.getElementById('result');
        const timeResultEl = document.getElementById('machiningTimeResult');
        
        let currentOperationDistance = 0; // 只計算當前這次操作的路徑

        const num = id => { const v = parseFloat(document.getElementById(id)?.value); return isNaN(v) ? null : v; };
        const txt = id => (document.getElementById(id)?.value ?? "").trim();
        const fmt = (v, dec = 3) => (v == null || isNaN(v)) ? '-' : (+v).toFixed(dec);
        
        const toolNo = txt('toolNo') || '99', sys = txt('gcode') || 'G54', x0 = num('x') ?? 0, y0 = num('y') ?? 0, zsafe = num('zsafe') ?? 20, zsurf = num('zsurface') ?? 0, Dc = num('toolDiameter'), Vc = num('vc'), N = num('n'), Zteeth = num('z'), Fz = num('fz');
        let Vf = num('vf');
        if ((Vf == null || isNaN(Vf)) && N && Fz && Zteeth) { Vf = N * Fz * Zteeth; }

        out.push(`(=== NC Helix Drill / ${mode} ===)`);
        out.push(`(Tool Dc=${fmt(Dc, 3)} mm, Vc=${fmt(Vc, 1)} m/min, N=${fmt(N, 0)} rpm, z=${fmt(Zteeth, 0)}, fz=${fmt(Fz, 3)} mm/tooth, Vf=${fmt(Vf, 1)} mm/min)`);
        out.push(`${sys} G00 X${fmt(x0, 3)} Y${fmt(y0, 3)} `);
        out.push(`G43 H${toolNo} Z${fmt(zsafe, 3)} `);

        function buildHelixSection(label, machiningDia, depth, pitch) {
          let sectionDistance = 0;
          if (machiningDia == null || depth == null || pitch == null) return { gcode: [`(WARN) ${label}: missing required fields, skipped.`], distance: 0 };
          if (!Dc) return { gcode: [`(WARN) ${label}: unknown tool diameter (Dc), skipped.`], distance: 0 };
          
          const block = [], R = (machiningDia - Dc) / 2, steps = Math.max(1, Math.ceil(depth / pitch)), effPitch = depth / steps;
          block.push(`(--- ${label} ---)`, `(Target Ø=${fmt(machiningDia, 3)}; Depth L=${fmt(depth, 3)}; Pitch=${fmt(pitch, 3)}; R=${fmt(R, 3)})`, `G00 Z${fmt(zsurf + 2, 3)} `);
          
          if (R > 1e-4) {
            block.push(`G01 X${fmt(x0 + R, 3)} Z${fmt(zsurf, 3)} F${fmt(Vf || 200, 1)} `);
            sectionDistance += Math.sqrt(R*R + 4);
            let currentZ = zsurf;
            for (let i = 1; i <= steps; i++) {
              currentZ -= effPitch;
              block.push(`G03 I${fmt(-R, 3)} Z${fmt(currentZ, 3)} F${fmt(Vf || 200, 1)} `);
              sectionDistance += Math.sqrt(Math.pow(2 * Math.PI * R, 2) + Math.pow(effPitch, 2));
            }
          }
          block.push(`G03 I${fmt(-R, 3)} F${fmt(Vf || 200, 1)} `);
          sectionDistance += 2 * Math.PI * R;
          block.push(`G01 X${fmt(x0, 3)} Y${fmt(y0, 3)} F${fmt(Vf || 200, 1)} `);
          sectionDistance += R;
          block.push(`G00 Z${fmt(zsafe, 3)} `);
          return { gcode: block, distance: sectionDistance };
        }

        if (mode === 'Mode1') {
          const section = buildHelixSection('Mode1', num('machiningDia1'), num('depthDia1'), num('pitch1'));
          out.push(...section.gcode);
          currentOperationDistance += section.distance;
        } else if (mode === 'Mode2') {
          const section1 = buildHelixSection('Mode2_Step1', num('machiningDia1'), num('depthDia1'), num('pitch1'));
          out.push(...section1.gcode);
          currentOperationDistance += section1.distance;
          const section2 = buildHelixSection('Mode2_Step2', num('machiningDia2'), num('depthDia2'), num('pitch2'));
          out.push(...section2.gcode);
          currentOperationDistance += section2.distance;
        }

        out.push(`(=== End ===)`);
        if (result.value && !result.value.endsWith('\n')) result.value += '\n';
        result.value += out.join('\n') + '\n\n';
        result.scrollTop = result.scrollHeight;

        // 計算並累加時間
        if (Vf > 0 && currentOperationDistance > 0) {
          const timeForThisOperation = (currentOperationDistance / Vf) * 60;
          cumulativeMachiningTimeInSeconds += timeForThisOperation; // 將本次時間累加到總時間上

          const timeTemplate = LangCtl.get('form.results.machiningTime', 'Estimated Machining Time: {time} sec');
          timeResultEl.textContent = timeTemplate.replace('{time}', cumulativeMachiningTimeInSeconds.toFixed(2)); // 顯示累計後的總時間
          timeResultEl.classList.remove('text-muted');
          timeResultEl.classList.add('text-primary');
        }
        // 如果無法計算，則不更新時間顯示，保留上一次的總時間
      }

      // ▼▼▼ 2. 更新 clearOutput 函式 ▼▼▼
      function clearOutput() {
        document.getElementById("result").value = "";
        document.getElementById('machiningTimeResult').textContent = '';
        cumulativeMachiningTimeInSeconds = 0; // 將累計時間歸零
      }
    </script>
  </section>

  <footer class="site-footer">
    <div class="footer-topbar"></div>
    <div class="container py-5">
      <div class="row gy-4 align-items-start">
        <div class="col-12 col-md-6 col-lg-3 text-center">
          <img src="https://nine9.jic-tools.com.tw/upload_files/technology/NC_Program/Jimmore_footer_logo.png"
            alt="JIMMORE" class="footer-logo mb-3 mx-auto d-block">
          <div class="badge-row mb-3">
            <img src="https://nine9.jic-tools.com.tw/upload_files/technology/NC_Program/Jimmore_footer-iso_01.png"
              alt="SGS">
            <img src="https://nine9.jic-tools.com.tw/upload_files/technology/NC_Program/Jimmore_footer-iso_02.png"
              alt="SGS">
            <img src="https://nine9.jic-tools.com.tw/upload_files/technology/NC_Program/Jimmore_footer-iso_03.png"
              alt="UKAS">
          </div>
          <a href="#" target="_blank" rel="noopener">
            <img src="https://www.jic-tools.com.tw/themes/jictools2/images/Jimmore-footer-iso_2.png"
              alt="D-U-N-S Certified" class="duns-img">
          </a>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <div class="footer-underline"></div>
          <address class="mb-0 small lh-lg">
            No.120-2, Sec-2 Fusing Rd., South District,<br>Taichung City 402014, Taiwan
          </address>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <div class="footer-underline"></div>
          <p class="small mb-2">
            TEL: <a href="tel:+886422605352" class="link-light text-decoration-none">+886-4-22605352</a><br>
            FAX: +886-4-22608765<br>
            E-mail:
            <a href="mailto:trade@jimmore.com.tw" class="link-light text-decoration-none">trade@jimmore.com.tw</a>
          </p>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <div class="footer-underline"></div>
          <p class="small mb-2">
            Copyright © <span id="year"></span> Jimmore International Corp.<br>
            All Rights Reserved.
          </p>
          <ul class="list-unstyled small mb-0"></ul>
        </div>
      </div>
    </div>
    <script>
      document.getElementById('year').textContent = (new Date()).getFullYear();
    </script>
  </footer>

  <button type="button" class="btn btn-dark btn-lg rounded-circle " id="backToTopBtn" title="回到頂部">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-up"
      viewBox="0 0 16 16">
      <path fill-rule="evenodd"
        d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z" />
    </svg>
  </button>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/lang-control.js"></script>
  <script src="js/interactive.js"></script>
</body>

</html>
